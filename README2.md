
WEB业务系统日志埋点建议
==================

- __一般，我们可以对本系统的日志分两大类型：诊断类型日志（内容记录在 msg 字段）、统计类型日志（主要内容记录在event_detail）__

- __对整个WEB系统的 “所有请求的入口” 和 “所有响应出口” 做埋点，记录好 HTTP 请求的参数和响应值 ；如：访问时间、用户IP、访问的URL、用户浏览器信息、HTTP状态码、请求处理时间__

- __记录日志信息需要完整，一般至少包括基本的三要素：是谁、在什么时候、做了什么 ；例如： "237463|login_success|2016-11-10"__

- __"业务点"需要做埋点，例如：“登录”、“退出”、“修改用户资料”、“用户活跃”、“签到”、“获得积分”、“消耗积分” 等__

- __敏感信息务必不输出日志，比如 “用户账号密码”、“用户身份证银行卡” 等__

- __“所有的异常处” 做埋点，包括系统异常和业务异常__

- __为每一次的用户WEB请求，生成一个唯一的 RequestId __

- __需要定期对不合理的日志内容进行优化更新__

- __新上线系统，对于不确定执行效率的方法，可以打印日志，进行观察；__

- __与外部系统交互的部分需要做埋点__

- __DEBUG 日志不建议过多，影响性能__

- __不打印无用的日志__

- __严格使用日志级别__

- __DEBUG 级别仅用于开发环境__

- __INFO 级别以上用于正式环境__

- __DEBUG 开发人员使用，方便观察调试即可，不汇入 ELK 日志规范体系__

- __INFO 记录业务处理流向用于追踪用户行为，记录关键业务数据用于后续分析统计__

- __WARN 一般记录由于用户输入不当，引起的系统不能按照主流程执行；比如：在用户登录表单，要求用户输入“手机号码”的，由于用户误操作输入了“昵称”，此时系统接收到请求，需要记录一条 WARN 级别的日志__

- __ERROR 一般是记录系统的异常，需要开发人员立即介入修复，而非用户错误输入导致。注意和 WARN 严格区分，WARN记录日志的同时一般需要给用户一个友好的提示反馈，建议用户修复 WARN 问题，而非开发者。所以，开发者一般解决BUG只需要关注自己系统内部的ERROR，忽略WARN__
